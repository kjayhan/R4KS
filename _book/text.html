<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>R for Korean Studies: A Gentle Introduction to Computational Social Science - 9&nbsp; Korean Text Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stats.html" rel="next">
<link href="./visuals-maps.html" rel="prev">
<link href="./r4ks Logo square 512.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-6J6HBMRCFK"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-6J6HBMRCFK', { 'anonymize_ip': true});
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./text.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Korean Text Analysis</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R for Korean Studies: A Gentle Introduction to Computational Social Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://www.github.com/kjayhan/R4KS" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Setting Up</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Korean Studies Data Sources</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The Basics of R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Wrangling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visuals-tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Visualization: Tables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visuals-plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Visualization: Plots</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visuals-maps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data Visualization: Maps</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./text.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Korean Text Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Statistical Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Storytelling with Quarto</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./productivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Productivity Tools</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./api.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Working with API to get Korean Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kdiplo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Making Korean Data Visualization Social</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bootcamp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">R for Korean Studies Bootcamps</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#libraries" id="toc-libraries" class="nav-link active" data-scroll-target="#libraries"><span class="header-section-number">9.1</span> Libraries</a></li>
  <li><a href="#loading-pdf-data" id="toc-loading-pdf-data" class="nav-link" data-scroll-target="#loading-pdf-data"><span class="header-section-number">9.2</span> Loading pdf Data</a></li>
  <li><a href="#pdf-table-extraction" id="toc-pdf-table-extraction" class="nav-link" data-scroll-target="#pdf-table-extraction"><span class="header-section-number">9.3</span> pdf Table Extraction</a></li>
  <li><a href="#html-table-extraction" id="toc-html-table-extraction" class="nav-link" data-scroll-target="#html-table-extraction"><span class="header-section-number">9.4</span> html Table Extraction</a></li>
  <li>
<a href="#text-analysis" id="toc-text-analysis" class="nav-link" data-scroll-target="#text-analysis"><span class="header-section-number">9.5</span> Text Analysis</a>
  <ul class="collapse">
<li><a href="#word-frequency" id="toc-word-frequency" class="nav-link" data-scroll-target="#word-frequency"><span class="header-section-number">9.5.1</span> Word Frequency</a></li>
  <li><a href="#spacing-in-korean-text" id="toc-spacing-in-korean-text" class="nav-link" data-scroll-target="#spacing-in-korean-text"><span class="header-section-number">9.5.2</span> Spacing in Korean Text</a></li>
  <li><a href="#morpheme-analysis-in-korean-text" id="toc-morpheme-analysis-in-korean-text" class="nav-link" data-scroll-target="#morpheme-analysis-in-korean-text"><span class="header-section-number">9.5.3</span> Morpheme Analysis in Korean Text</a></li>
  <li><a href="#word-network-in-korean-text" id="toc-word-network-in-korean-text" class="nav-link" data-scroll-target="#word-network-in-korean-text"><span class="header-section-number">9.5.4</span> Word Network in Korean Text</a></li>
  <li><a href="#sentiment-analysis" id="toc-sentiment-analysis" class="nav-link" data-scroll-target="#sentiment-analysis"><span class="header-section-number">9.5.5</span> Sentiment Analysis</a></li>
  <li><a href="#topic-modeling" id="toc-topic-modeling" class="nav-link" data-scroll-target="#topic-modeling"><span class="header-section-number">9.5.6</span> Topic Modeling</a></li>
  </ul>
</li>
  <li><a href="#korean-tweet-analysis" id="toc-korean-tweet-analysis" class="nav-link" data-scroll-target="#korean-tweet-analysis"><span class="header-section-number">9.6</span> Korean Tweet Analysis</a></li>
  <li><a href="#further-readings" id="toc-further-readings" class="nav-link" data-scroll-target="#further-readings"><span class="header-section-number">9.7</span> Further Readings</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">9.8</span> References</a></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info"><span class="header-section-number">9.9</span> Session Info</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Korean Text Analysis</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>In this chapter, we will learn how to analyze Korean text data using R. Korea’s 2024 Public Diplomacy Comprehensive Implementation Plan (2024년 공공외교 종합시행계획 개요) as an example text.</p>
<p>We will learn the following things in order:</p>
<ul>
<li>Extracting text and tables from a PDF file.</li>
<li>Extracting text and tables from the internet.</li>
<li>Ensuring accurate spacing between words in Korean text.</li>
<li>Analyzing morphemes in Korean text.</li>
<li>Analyzing word frequency in Korean text.</li>
<li>Analyzing the noun word network in Korean text.</li>
<li>Analyzing the sentiment of Korean text.</li>
<li>Topic modeling of Korean text.</li>
<li>Korean tweet analysis.</li>
</ul>
<section id="libraries" class="level2" data-number="9.1"><h2 data-number="9.1" class="anchored" data-anchor-id="libraries">
<span class="header-section-number">9.1</span> Libraries</h2>
<p>First, we need to install <a href="https://r2bit.com/bitNLP/"><code>bitNLP</code></a> which requires us to install the <a href="https://taku910.github.io/mecab/"><code>MeCab</code></a> library for Korean text analysis. Uncomment the following lines in your first usage. After the first usage, you can comment out the installation lines.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="co"># remotes::install_github("bit2r/bitNLP")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">bitNLP</span><span class="op">)</span></span>
<span><span class="co"># install_mecab_ko()</span></span>
<span><span class="co"># install.packages("RcppMeCab")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now let’s load the necessary libraries. If you are missing any of the following packages, you can install them by uncommenting the <code>install.packages</code> lines.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># install.packages("tidyverse")</span></span>
<span><span class="co"># install.packages("pdftools")</span></span>
<span><span class="co"># install.packages("rvest")</span></span>
<span><span class="co"># install.packages("tidytext")</span></span>
<span><span class="co"># install.packages("igraph")</span></span>
<span><span class="co"># install.packages("ggraph")</span></span>
<span><span class="co"># install.packages("extrafont")</span></span>
<span><span class="co"># install.packages("devtools")</span></span>
<span><span class="co"># devtools::install_github("koheiw/stopwords")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/pdftools/">pdftools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rvest.tidyverse.org/">rvest</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://juliasilge.github.io/tidytext/">tidytext</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/">igraph</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com">ggraph</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/wch/extrafont">extrafont</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/quanteda/stopwords">stopwords</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="loading-pdf-data" class="level2" data-number="9.2"><h2 data-number="9.2" class="anchored" data-anchor-id="loading-pdf-data">
<span class="header-section-number">9.2</span> Loading pdf Data</h2>
<p>Let’s analyze the text from Korea’s 2024 Public Diplomacy Comprehensive Implementation Plan (2024년 공공외교 종합시행계획 개요) which is available as a pdf file on the Ministry of Foreign Affairs’ (MOFA) <a href="https://www.mofa.go.kr/cntntsDown.do?path=www&amp;physic=2024%EB%85%84%EB%8F%84_%EA%B3%B5%EA%B3%B5%EC%99%B8%EA%B5%90_%EC%A2%85%ED%95%A9%EC%8B%9C%ED%96%89%EA%B3%84%ED%9A%8D.pdf&amp;real=2024%EB%85%84%EB%8F%84_%EA%B3%B5%EA%B3%B5%EC%99%B8%EA%B5%90_%EC%A2%85%ED%95%A9%EC%8B%9C%ED%96%89%EA%B3%84%ED%9A%8D.pdf">website</a><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>If the pdf file is in your local directory, you can load it using the following code.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load PDF</span></span>
<span><span class="va">pdf_path</span> <span class="op">&lt;-</span> <span class="st">"data/2024공공외교.pdf"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Alternatively, you can download the pdf file from the MOFA’s website using the <a href="https://henrikbengtsson.github.io/R.utils/reference/downloadFile.character.html"><code>download.file</code></a> function. You can then load the pdf file using the <code>pdf_path</code> variable. Working with the online pdf file and the local pdf file is the same. We can do either. For now, I will use the local pdf file since the MOFA might change the url for the pdf later. That is why I commented the download code. You can comment the earlier code for the local pdf file and uncomment the following code for the online pdf file.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Download PDF</span></span>
<span><span class="co">#file &lt;- tempfile()</span></span>
<span></span>
<span><span class="co"># This url works for now. But MOFA might change it later. You can replace the link with any other link you want to download.</span></span>
<span></span>
<span><span class="co">#url &lt;- "https://www.mofa.go.kr/cntntsDown.do?path=www&amp;physic=2024%EB%85%84%EB%8F%84_%EA%B3%B5%EA%B3%B5%EC%99%B8%EA%B5%90_%EC%A2%85%ED%95%A9%EC%8B%9C%ED%96%89%EA%B3%84%ED%9A%8D.pdf&amp;real=2024%EB%85%84%EB%8F%84_%EA%B3%B5%EA%B3%B5%EC%99%B8%EA%B5%90_%EC%A2%85%ED%95%A9%EC%8B%9C%ED%96%89%EA%B3%84%ED%9A%8D.pdf"</span></span>
<span></span>
<span><span class="co"># download.file(url, pdf_path, headers = c("User-Agent" = "My Custom User Agent"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now let’s extract the text from the pdf file using the <a href="https://docs.ropensci.org/pdftools/reference/pdftools.html"><code>pdf_text</code></a> function from the <a href="https://docs.ropensci.org/pdftools/index.html"><code>pdftools</code></a> package.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Extract text</span></span>
<span><span class="va">pdf_text_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/pdftools/reference/pdftools.html">pdf_text</a></span><span class="op">(</span><span class="va">pdf_path</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, <code>pdf_text_all</code> is a list of character vectors, where each element corresponds to a page in the pdf file. For example, we can look at the 4<sup>th</sup> page of the pdf file in the following way.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Let's look at the 4th page</span></span>
<span><span class="va">pdf_text_all</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "참고       기관별 사업규모 및 예산\n[중앙행정기관]\n                  ‘24년     ‘23년      ‘24년 예산         ‘23년 예산\n       기관명\n                  사업수      사업수         (백만원)           (백만원)\n 1    교육부             16       16          194,996          94,963\n 2    과학기술정보통신부        6        6           32,852          40,283\n 3    외교부             73       63           40,215          39,419\n3-1   한국국제교류재단        37       41           42,514          44,664\n 4    통일부              6        6            1,831           2,386\n 5    법무부              3        3           15,068          14,346\n 6    국방부              7        8            6,165           7,221\n 7    행정안전부            3        3              594             574\n 8    문화체육관광부         21       22          185,478         145,049\n 9    농림축산식품부          6        7            3,048           4,268\n10    보건복지부            7        7            6,497           8,557\n11    환경부              1        1            1,888           1,427\n12    고용노동부            1        1            1,264           1,529\n13    여성가족부            6        7            1,531           2,748\n14    국토교통부            4        4            2,394           2,394\n15    중소벤처기업부          5        5            7,246           5,548\n16    국가보훈부            1        1            8,774           3,637\n17    법제처              2        2              327             327\n18    해양수산부            1        1              100             100\n19    재외동포청            5        -           22,289               -\n        합계           211      204         475,038         419,440\n\n[지자체]\n                  ‘24년     ‘23년      ‘24년 예산         ‘23년 예산\n       기관명\n                  사업수      사업수         (백만원)           (백만원)\n 1    경기도             25       14          21,558            3,899\n 2    강원특별자치도         10       11          78,593          11,024\n 3    충청북도             7        8             789              736\n 4    충청남도            10       10           2,508            1,731\n 5    전라북도            19       19           2,626          10,703\n 6    전라남도            13       13           2,962            6,917\n 7    경상북도            18       18            2709            3,314\n 8    경상남도             8       10            미정              1,408\n 9    제주특별자치도         23       24           4,433            7,343\n10    서울특별시           31       31          10,005            9,628\n11    부산광역시           36       35           3,017            2,355\n12    대구광역시           11       11             316              321\n13    인천광역시           26       25           5,516            5,008\n14    광주광역시           22       26           3,487            6,459\n15    대전광역시           38       44            3685            3,848\n16    울산광역시           17       14           1,302              660\n17    세종특별자치시          8        9              96              373\n        합계           322      322         143,602          75,727\n\n\n                             - 4 -\n"</code></pre>
</div>
</div>
<p>You can see that there are <code>\n</code> characters, which refers to newline (new line) in the text. Let’s split the text by the newline character and look at the first 10 lines of the 4th page. We can split the text into lines by using the <a href="https://stringr.tidyverse.org/reference/str_split.html"><code>str_split</code></a> function from the <a href="https://stringr.tidyverse.org/"><code>stringr</code></a> package, which is part of <a href="https://www.tidyverse.org/"><code>tidyverse</code></a>. So, we do not need to load it separately. Let’s look at the first six lines of the 4th page.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Look at the first 10 lines of the 4th page</span></span>
<span><span class="va">pdf_text_all</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># Split by newline character.</span></span>
<span>  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="st">"\n"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># Unlist</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Take the first 10 lines</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "참고       기관별 사업규모 및 예산"                                         
 [2] "[중앙행정기관]"                                                             
 [3] "                  ‘24년     ‘23년      ‘24년 예산         ‘23년 예산"       
 [4] "       기관명"                                                              
 [5] "                  사업수      사업수         (백만원)           (백만원)"   
 [6] " 1    교육부             16       16          194,996          94,963"      
 [7] " 2    과학기술정보통신부        6        6           32,852          40,283"
 [8] " 3    외교부             73       63           40,215          39,419"      
 [9] "3-1   한국국제교류재단        37       41           42,514          44,664" 
[10] " 4    통일부              6        6            1,831           2,386"      </code></pre>
</div>
</div>
<p>The 4th page in the pdf file looks like this:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="data/2024pd4.png" class="img-fluid figure-img"></p>
<figcaption>2024 Public Diplomacy Comprehensive Implementation Plan, p.&nbsp;4</figcaption></figure>
</div>
</section><section id="pdf-table-extraction" class="level2" data-number="9.3"><h2 data-number="9.3" class="anchored" data-anchor-id="pdf-table-extraction">
<span class="header-section-number">9.3</span> pdf Table Extraction</h2>
<p>Let’s try to extract the second table on page 4 of the pdf file. The table has the number of public diplomacy projects and budgets for <a href="https://www.mois.go.kr/eng/sub/a03/citiesprovinces/screen.do">first-tier local administration unit</a> (hereafter, <em>province_city</em> for short) in Korea. We will unlist each line as we did earlier so that we can see the table in a more readable way.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Look at the first 10 lines of the 4th page</span></span>
<span><span class="va">lines_pdf_4</span> <span class="op">&lt;-</span> <span class="va">pdf_text_all</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># Split by newline character.</span></span>
<span>  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="st">"\n"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># Unlist</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>First, let’s look at the 29<sup>th</sup> and 30<sup>th</sup> lines for the column names in the pdf file.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lines_pdf_4</span><span class="op">[</span><span class="fl">29</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "                  ‘24년     ‘23년      ‘24년 예산         ‘23년 예산"
[2] "       기관명"                                                       </code></pre>
</div>
</div>
<p>The column names are the line number, province or city’s name, project numbers for 2024 and 2023 respectively, and the budget for 2024 and 2023 in million Korean Won respectively. Let’s use the following English column names that correspond to the Korean column names in the pdf file.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Column names</span></span>
<span><span class="va">col_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"province_city"</span>, <span class="st">"project_no_2024"</span>, <span class="st">"project_no_2023"</span>, <span class="st">"budget_2024"</span>, <span class="st">"budget_2023"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>By observing the <code>lines_pdf_4</code> object using <code>view(lines_pdf_4)</code>, we can see that the second table starts from the 32<sup>nd</sup> line and ends on the 48<sup>th</sup>. We will extract only those lines. We will use <a href="https://stringr.tidyverse.org/reference/str_trim.html"><code>str_trim</code></a> “removes whitespace from start and end of string”. We will also use <a href="https://stringr.tidyverse.org/reference/str_replace.html"><code>str_replace_all</code></a> to remove commas from each line to convert entries into numbers. We will then split each line based on two or more consecutive spaces (our string is “<code>\s{2,}</code>”) using <a href="https://stringr.tidyverse.org/reference/str_split.html"><code>str_split</code></a> and simplify the result into a matrix. We will convert this matrix into a data frame with non-factor columns using <code>data.frame(stringsAsFactors = FALSE)</code>. We will set the column names of the data frame using the <code>col_names</code> vector that we created above. These explanations are also available in each step in the following code chunk.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Select lines 32 to 48 from the lines_pdf_4 data frame</span></span>
<span><span class="va">province_city_pd</span> <span class="op">&lt;-</span> <span class="va">lines_pdf_4</span><span class="op">[</span><span class="fl">32</span><span class="op">:</span><span class="fl">48</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Trim whitespace from both ends of each element in the selected rows</span></span>
<span>  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_trim.html">str_trim</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Replace all commas with an empty string in each element</span></span>
<span>  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="st">","</span>, <span class="st">""</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Split each element based on 2 or more consecutive spaces and simplify into a matrix</span></span>
<span>  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="st">"\\s{2,}"</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Convert the matrix into a data frame with non-factor columns</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Set column names for the data frame using the provided 'col_names' vector</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="va">col_names</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s rearrange the table (which is originally in alphabetical order) by descending order based on public diplomacy budgets in 2024.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">province_city_pd</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">budget_2024</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   no  province_city project_no_2024 project_no_2023 budget_2024 budget_2023
1   8       경상남도               8              10        미정        1408
2  17 세종특별자치시               8               9          96         373
3   3       충청북도               7               8         789         736
4   2 강원특별자치도              10              11       78593       11024
5  13     인천광역시              26              25        5516        5008
6   9 제주특별자치도              23              24        4433        7343
7  15     대전광역시              38              44        3685        3848
8  14     광주광역시              22              26        3487        6459
9  12     대구광역시              11              11         316         321
10 11     부산광역시              36              35        3017        2355
11  6       전라남도              13              13        2962        6917
12  7       경상북도              18              18        2709        3314
13  5       전라북도              19              19        2626       10703
14  4       충청남도              10              10        2508        1731
15  1         경기도              25              14       21558        3899
16 16     울산광역시              17              14        1302         660
17 10     서울특별시              31              31       10005        9628</code></pre>
</div>
</div>
<p>But these province_city names are in Korean since the document was in Korean. Let’s practice extracting a table from internet then to find English names for these Korean provinces or cities. As of May 6, 2024, <a href="https://en.wikipedia.org/wiki/Administrative_divisions_of_South_Korea">Wikipedia’s list of South Korea’s administrative divisions</a> seems to be correct. Let’s extract the table there.</p>
</section><section id="html-table-extraction" class="level2" data-number="9.4"><h2 data-number="9.4" class="anchored" data-anchor-id="html-table-extraction">
<span class="header-section-number">9.4</span> html Table Extraction</h2>
<p>We will use the <a href="https://rvest.tidyverse.org/"><code>rvest</code></a> package to extract the table from the Wikipedia page. We will use the <a href="https://rvest.tidyverse.org/reference/read_html.html"><code>read_html</code></a> function to read the html content of the Wikipedia page. We will then use the <a href="https://rvest.tidyverse.org/reference/html_nodes.html"><code>html_node</code></a> function to select the table we want to extract. You can refer to <a href="https://rvest.tidyverse.org/"><code>rvest</code></a> package for more information on how to extract what you want. We can use the xpath of the table we want to extract. You can find the xpath of the table by right-clicking on the table on the Wikipedia page and selecting “Inspect” or “Inspect Element” depending on your browser. You can then right-click on the highlighted html element in the “Elements” tab of the “Developer Tools” and select “Copy” -&gt; “Copy XPath”. The xpath of the table we want to extract is <code>//*[@id="mw-content-text"]/div[1]/table[5]</code>. We will use the <a href="https://rvest.tidyverse.org/reference/html_table.html"><code>html_table</code></a> function to extract the table as a data frame. We will use the <code>fill = TRUE</code> argument to fill in the missing values in the table.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">html</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://xml2.r-lib.org/reference/read_xml.html">read_html</a></span><span class="op">(</span><span class="st">"https://en.wikipedia.org/wiki/Administrative_divisions_of_South_Korea"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="va">html</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/rename.html">html_node</a></span><span class="op">(</span>xpath <span class="op">=</span> <span class="st">'//*[@id="mw-content-text"]/div[1]/table[5]'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_table.html">html_table</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s look at the first 10 rows of the table.</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">table</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  Code  Emblem Name   Official English nam…¹ Hangul Hanja Population 2020 Cens…²
  &lt;chr&gt; &lt;lgl&gt;  &lt;chr&gt;  &lt;chr&gt;                  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;                 
1 KR-11 NA     Seoul… Seoul                  서울…  .mw-… 9,586,195             
2 KR-26 NA     Busan… Busan                  부산…  釜山… 3,349,016             
3 KR-27 NA     Daegu… Daegu                  대구…  大邱… 2,410,700             
4 KR-28 NA     Inche… Incheon                인천…  仁川… 2,945,454             
5 KR-29 NA     Gwang… Gwangju                광주…  光州… 1,477,573             
6 KR-30 NA     Daeje… Daejeon                대전…  大田… 1,488,435             
# ℹ abbreviated names: ¹​`Official English name[5]`, ²​`Population 2020 Census`
# ℹ 2 more variables: `Area (km2)` &lt;chr&gt;,
#   `Population density  2022 (per km2)` &lt;chr&gt;</code></pre>
</div>
</div>
<p>Perfect! Now, let’s keep only the columns that we will need.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Select columns 4 and 5 from the table</span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="va">table</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Let's change the English province_city column name.</span></span>
<span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="va">table</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>province_city_eng <span class="op">=</span> <span class="va">`Official English name[5]`</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s hope that the Korean names in the Wikipedia table and the MOFA’s pdf file are the same. Let’s merge the two tables based on the Korean names.</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Merge the two tables based on the Korean names</span></span>
<span><span class="va">province_city_pd_joined</span> <span class="op">&lt;-</span> <span class="va">province_city_pd</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">table</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"province_city"</span> <span class="op">=</span> <span class="st">"Hangul"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s see if we have any missing values in the English names.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Check for missing values in the English names</span></span>
<span><span class="va">province_city_pd_joined</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">province_city_eng</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  no province_city project_no_2024 project_no_2023 budget_2024 budget_2023
1  5      전라북도              19              19        2626       10703
  province_city_eng
1              &lt;NA&gt;</code></pre>
</div>
</div>
<p>We almost got it! The only difference is 전라북도 (North Jeolla Province) in the MOFA’s pdf file which is written as 전북특별자치도 (Jeonbuk State) in the Wikipedia table. Let’s fix this.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Move the English name column next to the Korean name column, and remove the 'no' column</span></span>
<span></span>
<span><span class="va">province_city_pd_joined</span> <span class="op">&lt;-</span> <span class="va">province_city_pd_joined</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">province_city</span>, <span class="va">province_city_eng</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="op">-</span><span class="va">no</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fix the English name of 전라북도</span></span>
<span></span>
<span><span class="va">province_city_pd_joined</span> <span class="op">&lt;-</span> <span class="va">province_city_pd_joined</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>province_city_eng <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">province_city</span> <span class="op">==</span> <span class="st">"전라북도"</span>, <span class="st">"North Jeolla province_city"</span>, <span class="va">province_city_eng</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="text-analysis" class="level2" data-number="9.5"><h2 data-number="9.5" class="anchored" data-anchor-id="text-analysis">
<span class="header-section-number">9.5</span> Text Analysis</h2>
<section id="word-frequency" class="level3" data-number="9.5.1"><h3 data-number="9.5.1" class="anchored" data-anchor-id="word-frequency">
<span class="header-section-number">9.5.1</span> Word Frequency</h3>
<p>This time let’s look at all of the text in the 2024 Public Diplomacy Comprehensive Implementation Plan. We will combine all the text into a single character vector.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Combine text</span></span>
<span><span class="va">pdf_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="va">pdf_text_all</span>, collapse <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will now split the text into words using the <a href="https://stringr.tidyverse.org/reference/str_split.html"><code>str_split</code></a> function from the <a href="https://stringr.tidyverse.org/"><code>stringr</code></a> package. We will then convert the result into a data frame with non-factor columns using the <a href="https://rdocumentation.org/packages/base/versions/3.6.2"><code>data.frame(stringsAsFactors = FALSE)</code></a> function. We will set the column name of the data frame as <code>word</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Split the text into words</span></span>
<span><span class="va">words</span> <span class="op">&lt;-</span> <span class="va">pdf_text</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Split the text into words</span></span>
<span>  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="st">"\\s+"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Convert the result into a data frame with non-factor columns</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Set the column name of the data frame as "word"</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="st">"word"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s look at the first 10 rows of the data frame.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">words</span>, <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           word
1              
2        2024년
3      공공외교
4  종합시행계획
5          개요
6             
7          수립
8          근거
9             ❑
10   공공외교법</code></pre>
</div>
</div>
<p>Now, let’s count the frequency of each word in the text using the <a href="https://dplyr.tidyverse.org/reference/count.html"><code>count</code></a> function from the <a href="https://dplyr.tidyverse.org/"><code>dplyr</code></a> package package. We will then arrange the result in descending order based on the frequency of the words.</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Count the frequency of each word</span></span>
<span><span class="va">word_freq</span> <span class="op">&lt;-</span> <span class="va">words</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">word</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s look at the first 10 rows of the data frame</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">word_freq</span>, <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       word  n
1        및 72
2         - 55
3  공공외교 40
4        등 33
5        ㅇ 28
6     개최, 22
7      통한 22
8      사업 18
9      제고 18
10     강화 17</code></pre>
</div>
</div>
<p>This is not very useful. There are two main issues with Korean text. First, Korean text does not have consistent spacing between words. Second, Korean text has particles and other morphemes that are not words. We will address these issues now.</p>
</section><section id="spacing-in-korean-text" class="level3" data-number="9.5.2"><h3 data-number="9.5.2" class="anchored" data-anchor-id="spacing-in-korean-text">
<span class="header-section-number">9.5.2</span> Spacing in Korean Text</h3>
<p>Let’s get the spacing right in Korean text using the <a href="https://r2bit.com/bitNLP"><code>bitNLP</code></a> package’s <a href="https://r2bit.com/bitNLP/reference/get_spacing.html"><code>get_spacing</code></a> function, which will add spaces between words in the Korean text. So, for example “한국공공외교” will become “한국 공공 외교”.</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Get the spacing right in Korean text</span></span>
<span><span class="va">pdf_text_ko</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bitNLP/man/get_spacing.html">get_spacing</a></span><span class="op">(</span><span class="va">pdf_text</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, let’s split the text into words again using the <a href="https://stringr.tidyverse.org/reference/str_split.html"><code>str_split</code></a> function from the <a href="https://stringr.tidyverse.org/"><code>stringr</code></a> package.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Split the text into words</span></span>
<span><span class="va">words_ko</span> <span class="op">&lt;-</span> <span class="va">pdf_text_ko</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Split the text into words</span></span>
<span>  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="st">"\\s+"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Convert the result into a data frame with non-factor columns</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Set the column name of the data frame as "word"</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="st">"word"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s analyze the word frequency in the text again.</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Count the frequency of each word</span></span>
<span><span class="va">word_freq_ko</span> <span class="op">&lt;-</span> <span class="va">words_ko</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">word</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">word_freq_ko</span>, <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   word   n
1     ▴ 175
2     (  97
3     -  80
4    및  73
5  외교  67
6  공공  62
7  국제  36
8  사업  35
9    등  33
10 해외  30</code></pre>
</div>
</div>
<p>We have many special characters in the text. Let’s remove all characters except for Korean characters, spaces, English letters, and numbers using the <a href="https://stringr.tidyverse.org/reference/str_replace.html"><code>str_replace_all</code></a> function from the <a href="https://stringr.tidyverse.org/"><code>stringr</code></a> package.</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Remove all characters except for Korean characters, spaces, English letters, and numbers</span></span>
<span><span class="va">word_freq_ko</span> <span class="op">&lt;-</span> <span class="va">pdf_text_ko</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Remove all characters except Korean characters, English letters, numbers, and spaces</span></span>
<span>  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="st">"[^가-힣a-zA-Z0-9\\s]"</span>, <span class="st">""</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Split the cleaned text into words based on one or more spaces</span></span>
<span>  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="st">"\\s+"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Convert the list result into a data frame with non-factor columns</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Set the column name of the data frame as "word"</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="st">"word"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s analyze the word frequency in the text again.</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Count the frequency of each word</span></span>
<span><span class="va">word_freq_ko</span> <span class="op">&lt;-</span> <span class="va">word_freq_ko</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">word</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">word_freq_ko</span>, <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   word  n
1    및 73
2  외교 67
3  공공 62
4  개최 44
5  사업 37
6  국제 36
7    등 35
8  해외 30
9  문화 29
10 추진 28</code></pre>
</div>
</div>
<p>This is much better! We have removed the special characters and have more meaningful words in the text.</p>
<p>We can also remove some common stopwords in Korean using the <a href="https://github.com/koheiw/stopwords"><code>stopwords</code></a> function in <a href="https://github.com/koheiw/stopwords"><code>stopwords</code></a> package along with the <a href="https://github.com/stopwords-iso/stopwords-iso/"><code>stopwords-iso</code></a> library that has Korean stopwords.</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stopwords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/stopwords/man/stopwords.html">stopwords</a></span><span class="op">(</span><span class="st">"ko"</span>, source <span class="op">=</span> <span class="st">"stopwords-iso"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="st">"word"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove stopwords</span></span>
<span></span>
<span><span class="va">word_freq_ko</span> <span class="op">&lt;-</span> <span class="va">word_freq_ko</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># anti_join (remove) stopwords</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">anti_join</a></span><span class="op">(</span><span class="va">stopwords</span>, by <span class="op">=</span> <span class="st">"word"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s count the frequency of each word in the text again.</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">word_freq_ko</span>, <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   word  n
1  외교 67
2  공공 62
3  개최 44
4  사업 37
5  국제 36
6  해외 30
7  문화 29
8  추진 28
9  운영 25
10 강화 24</code></pre>
</div>
</div>
<p>This way, we removed words such as 및 (and) and 등 (etc.) from the text.</p>
<p>Let’s move on to morpheme analysis which makes more sense in Korean text analysis context.</p>
</section><section id="morpheme-analysis-in-korean-text" class="level3" data-number="9.5.3"><h3 data-number="9.5.3" class="anchored" data-anchor-id="morpheme-analysis-in-korean-text">
<span class="header-section-number">9.5.3</span> Morpheme Analysis in Korean Text</h3>
<p>Let’s analyze the morphemes in the Korean text using the <a href="https://r2bit.com/bitNLP/reference/morpho_mecab.html"><code>morpho_mecab</code></a> function from the <a href="https://r2bit.com/bitNLP"><code>bitNLP</code></a> package, which will extract morphemes from the Korean text.</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Analyze the morphemes in the Korean text</span></span>
<span><span class="va">morphemes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bitNLP/man/morpho_mecab.html">morpho_mecab</a></span><span class="op">(</span><span class="va">pdf_text_ko</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This creates a list of character vectors, where each element corresponds to a morpheme in the text. We can also combine all of the morphemes and tokenize them into a single character vector.</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Combine all the morphemes into a single character vector</span></span>
<span></span>
<span><span class="va">morphemes_single</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bitNLP/man/morpho_mecab.html">morpho_mecab</a></span><span class="op">(</span><span class="va">pdf_text_ko</span>, indiv <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, let’s split the text into words again this time by converting <code>morphemes_single</code> into a data frame using the <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/as.data.frame"><code>as.data.frame</code></a> function. We will set the column name of the data frame as “word”.</p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Split the text into words</span></span>
<span><span class="va">words_morphemes</span> <span class="op">&lt;-</span> <span class="va">morphemes_single</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Set the column name of the data frame as "word"</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="st">"word"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will now count the frequency of each morpheme in the text using the <a href="https://dplyr.tidyverse.org/reference/count.html"><code>count</code></a> function from the <a href="https://dplyr.tidyverse.org/"><code>dplyr</code></a> package package. We will then arrange the result in descending order based on the frequency of the morphemes.</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Count the frequency of each morpheme</span></span>
<span></span>
<span><span class="va">morpheme_freq</span> <span class="op">&lt;-</span> <span class="va">words_morphemes</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">word</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">morpheme_freq</span>, <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   word  n
1  외교 68
2  공공 62
3  개최 46
4  국제 39
5  사업 37
6  해외 30
7  문화 29
8  추진 28
9  운영 26
10 계획 25</code></pre>
</div>
</div>
<p>Now, this is more like it!</p>
<p>Let’s visualize the frequency of the morphemes in the text using a bar plot. Before that let’s address the font issue with Korean text in the plot.</p>
<p>Korean text sometimes is not visible in the graph due to the font issue. This was the case in my Macbook. Let’s set the font to one that supports Korean characters. We will use the <a href="https://github.com/wch/extrafont"><code>extrafont</code></a> package to set the font to one that supports Korean characters. We will use the <a href="https://github.com/wch/extrafont"><code>font_import</code></a> function to import the fonts from the system. This may take some time. You only need to do it once. That’s why I commented it. You can uncomment it in first usage.</p>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load extrafont and register fonts</span></span>
<span></span>
<span><span class="co">#font_import()  # This might take a while if it's the first time you're running it</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will then use the <a href="https://github.com/wch/extrafont"><code>loadfonts</code></a> function to load the fonts. We will use the <a href="https://github.com/wch/extrafont"><code>fonts</code></a> function to display the available fonts and find one that supports Korean characters. We will set the font to one that supports Korean characters. For now, I have chosen “Arial Unicode MS” as the Korean font. You can replace it with a font from your system that supports Korean characters if necessary.</p>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#loadfonts(device = "all")</span></span>
<span></span>
<span><span class="co"># Display available fonts, find one that supports Korean</span></span>
<span><span class="co">#fonts()</span></span>
<span></span>
<span><span class="co"># Set the font to one that supports Korean characters</span></span>
<span><span class="va">korean_font</span> <span class="op">&lt;-</span> <span class="st">"Arial Unicode MS"</span>  <span class="co"># Replace with a font from your system that supports Korean if necessary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will use the <a href="https://ggplot2.tidyverse.org/"><code>ggplot</code></a> function from the <a href="https://ggplot2.tidyverse.org/"><code>ggplot2</code></a> package to create the plot. We will use the <a href="https://ggplot2.tidyverse.org/reference/geom_col.html"><code>geom_col</code></a> function to add the bars to the plot. We will use the <a href="https://ggplot2.tidyverse.org/reference/theme_minimal.html"><code>theme_minimal</code></a> function to set the theme of the plot to minimal. We will use the <a href="https://ggplot2.tidyverse.org/reference/theme.html"><code>theme</code></a> function to adjust the font size in the plot. We will set the font size to 10. We will use the <a href="https://ggplot2.tidyverse.org/reference/labs.html"><code>labs</code></a> function to add the title and labels to the plot. We will visualize only the most frequent 20 morphemes in the text.</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Visualize the frequency of the morphemes in the text</span></span>
<span></span>
<span><span class="va">morpheme_freq</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/top_n.html">top_n</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>word <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">word</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">word</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#2196f3"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># use Korean font</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="va">korean_font</span>, size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Frequency of Morphemes in Korean Text"</span>, x <span class="op">=</span> <span class="st">"Morpheme"</span>, y <span class="op">=</span> <span class="st">"Frequency"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="text_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="word-network-in-korean-text" class="level3" data-number="9.5.4"><h3 data-number="9.5.4" class="anchored" data-anchor-id="word-network-in-korean-text">
<span class="header-section-number">9.5.4</span> Word Network in Korean Text</h3>
<p>Let’s analyze the word network in the Korean text using the <a href="https://r2bit.com/bitNLP/reference/tokenize_noun_ngrams.html"><code>tokenize_noun_ngrams</code></a> function from the <a href="https://r2bit.com/bitNLP/"><code>bitNLP</code></a> package which builds on <a href="https://r2bit.com/bitNLP/articles/with_tidytext.html"><code>tidytext</code></a> package. We will use the <code>tokenize_noun_grams</code> function to extract the noun word network from the Korean text.</p>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># We can use a user-defined dictionary to improve the accuracy of the tokenization. We will rely on the one provided by the `bitNLP` package.</span></span>
<span></span>
<span><span class="va">dic_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"dic"</span>, package <span class="op">=</span> <span class="st">"bitNLP"</span><span class="op">)</span></span>
<span><span class="va">dic_file</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"{dic_path}/buzz_dic.dic"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">word_network</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bitNLP/man/tokenize_noun_ngrams.html">tokenize_noun_ngrams</a></span><span class="op">(</span><span class="va">pdf_text_ko</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span>, user_dic <span class="op">=</span> <span class="va">dic_file</span>, n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="st">"paired_words"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, let’s separate the paired words into two columns using the <a href="https://tidyr.tidyverse.org/reference/separate.html"><code>separate</code></a> function from the <a href="https://tidyr.tidyverse.org/"><code>tidyr</code></a> package which is loaded as part of the <a href="https://www.tidyverse.org/"><code>tidyverse</code></a> package. This will allow us to create bigrams from the paired words.</p>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">word_network_separated</span> <span class="op">&lt;-</span> <span class="va">word_network</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span><span class="va">paired_words</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"word1"</span>, <span class="st">"word2"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will now count the frequency of each bigram in the text using the <a href="https://dplyr.tidyverse.org/reference/count.html"><code>count</code></a> function from the <a href="https://dplyr.tidyverse.org/"><code>dplyr</code></a> package package, which is also party of the <a href="https://www.tidyverse.org/"><code>tidyverse</code></a>. We will then arrange the result in descending order based on the frequency of the bigrams.</p>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># new bigram counts:</span></span>
<span><span class="va">word_network_counts</span> <span class="op">&lt;-</span> <span class="va">word_network_separated</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">word1</span>, <span class="va">word2</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will now create a graph from the bigram counts using the <a href="https://r.igraph.org/reference/graph_from_data_frame.html"><code>graph_from_data_frame</code></a> function from the <a href="https://r.igraph.org/"><code>igraph</code></a> package. We will use the <a href="https://ggraph.data-imaginist.com/reference/ggraph.html"><code>ggraph</code></a> function from the <a href="https://ggraph.data-imaginist.com"><code>ggraph</code></a> package to create the graph. We will use the <a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html"><code>geom_edge_link</code></a> function to add the edges to the graph. We will use the <a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html"><code>geom_node_point</code></a> function to add the nodes to the graph. We will use the <a href="https://ggraph.data-imaginist.com/reference/geom_node_text.html"><code>geom_node_text</code></a> function to add the labels to the nodes in the graph. We will set the font to the Korean font that we set earlier. We will then adjust the font in the graph. Here, <code>n &gt;= 6</code> is used to filter out bigrams that appear less than 6 times. You can adjust this number as needed. You can check out <code>ggraph</code> layout options <a href="https://cran.r-project.org/web/packages/ggraph/vignettes/Layouts.html">here</a>.</p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">word_network_select</span> <span class="op">&lt;-</span> <span class="va">word_network_counts</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://r.igraph.org/reference/graph_from_data_frame.html">graph_from_data_frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span>layout <span class="op">=</span> <span class="st">"fr"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#2196f3"</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_text.html">geom_node_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span><span class="op">)</span>, family <span class="op">=</span> <span class="va">korean_font</span>, vjust <span class="op">=</span> <span class="fl">2</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Set family to Korean font</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">word_network_select</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="text_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="sentiment-analysis" class="level3" data-number="9.5.5"><h3 data-number="9.5.5" class="anchored" data-anchor-id="sentiment-analysis">
<span class="header-section-number">9.5.5</span> Sentiment Analysis</h3>
</section><section id="topic-modeling" class="level3" data-number="9.5.6"><h3 data-number="9.5.6" class="anchored" data-anchor-id="topic-modeling">
<span class="header-section-number">9.5.6</span> Topic Modeling</h3>
</section></section><section id="korean-tweet-analysis" class="level2" data-number="9.6"><h2 data-number="9.6" class="anchored" data-anchor-id="korean-tweet-analysis">
<span class="header-section-number">9.6</span> Korean Tweet Analysis</h2>
</section><section id="further-readings" class="level2" data-number="9.7"><h2 data-number="9.7" class="anchored" data-anchor-id="further-readings">
<span class="header-section-number">9.7</span> Further Readings</h2>
</section><section id="references" class="level2" data-number="9.8"><h2 data-number="9.8" class="anchored" data-anchor-id="references">
<span class="header-section-number">9.8</span> References</h2>
</section><section id="session-info" class="level2" data-number="9.9"><h2 data-number="9.9" class="anchored" data-anchor-id="session-info">
<span class="header-section-number">9.9</span> Session Info</h2>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.0 (2024-04-24)
Platform: aarch64-apple-darwin20
Running under: macOS Sonoma 14.4.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: Asia/Seoul
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] stopwords_2.3     extrafont_0.19    ggraph_2.2.1      igraph_2.0.3     
 [5] tidytext_0.4.2    rvest_1.0.4       pdftools_3.4.0    lubridate_1.9.3  
 [9] forcats_1.0.0     stringr_1.5.1     dplyr_1.1.4       purrr_1.0.2      
[13] readr_2.1.5       tidyr_1.3.1       tibble_3.2.1      ggplot2_3.5.1    
[17] tidyverse_2.0.0   bitNLP_1.4.3.9000

loaded via a namespace (and not attached):
 [1] tidyselect_1.2.1    viridisLite_0.4.2   farver_2.1.1       
 [4] viridis_0.6.5       fastmap_1.1.1       tweenr_2.0.3       
 [7] janeaustenr_1.0.0   promises_1.3.0      shinyjs_2.1.0      
[10] digest_0.6.35       timechange_0.3.0    mime_0.12          
[13] lifecycle_1.0.4     qpdf_1.3.3          tokenizers_0.3.0   
[16] magrittr_2.0.3      compiler_4.4.0      rlang_1.1.3        
[19] sass_0.4.9          tools_4.4.0         utf8_1.2.4         
[22] knitr_1.46          labeling_0.4.3      askpass_1.2.0      
[25] graphlayouts_1.1.1  htmlwidgets_1.6.4   curl_5.2.1         
[28] xml2_1.3.6          miniUI_0.1.1.1      ngram_3.2.3        
[31] withr_3.0.0         grid_4.4.0          polyclip_1.10-6    
[34] fansi_1.0.6         xtable_1.8-4        colorspace_2.1-0   
[37] extrafontdb_1.0     scales_1.3.0        MASS_7.3-60.2      
[40] cli_3.6.2           rmarkdown_2.26      generics_0.1.3     
[43] RcppParallel_5.1.7  rstudioapi_0.16.0   httr_1.4.7         
[46] tzdb_0.4.0          cachem_1.0.8        ggforce_0.4.2      
[49] RcppMeCab_0.0.1.2   parallel_4.4.0      rhandsontable_0.3.8
[52] vctrs_0.6.5         Matrix_1.7-0        jsonlite_1.8.8     
[55] hms_1.1.3           ggrepel_0.9.5       jquerylib_0.1.4    
[58] shinyBS_0.61.1      glue_1.7.0          stringi_1.8.3      
[61] gtable_0.3.5        later_1.3.2         munsell_0.5.1      
[64] pillar_1.9.0        htmltools_0.5.8.1   R6_2.5.1           
[67] tidygraph_1.3.1     evaluate_0.23       shiny_1.8.1.1      
[70] lattice_0.22-6      SnowballC_0.7.1     memoise_2.0.1      
[73] DataEditR_0.1.5     httpuv_1.6.15       bslib_0.7.0        
[76] Rcpp_1.0.12         Rttf2pt1_1.3.12     gridExtra_2.3      
[79] xfun_0.43           pkgconfig_2.0.3    </code></pre>
</div>
</div>


</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>Please bear in mind that MOFA website’s url might change later, making this hyperlink broken. In that case, you can download the pdf file on the MOFA’s website by searching for “2024년 공공외교 종합시행계획 개요”.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/r4ks\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./visuals-maps.html" class="pagination-link" aria-label="Data Visualization: Maps">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data Visualization: Maps</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stats.html" class="pagination-link" aria-label="Statistical Analysis">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Statistical Analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2024 <a href="https://ayhan.phd">Kadir Jun Ayhan</a> &amp; <a href="https://k-a.phd">K-Analytics</a> - <a href="https://www.linkedin.com/company/k-a-phd/">Linkedin</a> - <a href="mailto:k@ayhan.phd">Email</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Written with <a href="https://quarto.org/">Quarto</a> - Source code on <a href="https://github.com/kjayhan/R4KS">GitHub</a></p>
</div>
  </div>
</footer>


</body></html>